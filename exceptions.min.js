(function(){var g,j,i,c,b;b={scriptTag:function a(k,m){var l=document.createElement("script");l.type="text/javascript";l.src=k;l.async=false;l.onreadystatechange=l.onload=function(){try{var n=l.readyState;if(m&&!m.done&&(!n||/loaded|complete/.test(n))){m.done=true;m()}}catch(o){console.log("Error in exceptions.js!");console.log(o)}};(document.body||document.head).appendChild(l)},functionName:function(k){var l=k.toString();l=l.substr("function ".length);l=l.substr(0,l.indexOf("("));return l}};function h(){if(!(this instanceof h)){return new h()}this._stacktrace=false;this._screenshot=false;this._post=false;this._callback=false}h.prototype={stacktrace:function(k){if(k!==undefined){this._stacktrace=Boolean(k);return this}return this._stacktrace},screenshot:function(k){if(k!==undefined){this._screenshot=Boolean(k);return this}return this._screenshot},post:function(k){if(k!==undefined){this._post=Boolean(k);return this}return this._post},callback:function(k){if(k!==undefined){this._callback=Boolean(k);return this}return this._callback},toggleAll:function(k){return this.stacktrace(k).screenshot(k).post(k).callback(k)}};function f(k){f._mixStaticFunctions(k.exception);f._inherits(k.exception,k.baseException);f._setupDefaults(k.exception,k.baseException,k.defaultType,k.defaultOptionsFunc);return k.exception}f._createThrowIf=function(m){var l=b.functionName(m);return function k(p,o){if(p){var n=new m({error:new Error(o||l)});throw n}}};f._createReportIf=function(m){var l=b.functionName(m);return function k(p,o){if(p){var n=new m({error:new Error(o||l)});n.report()}}};f._createDefaultType=function(k){return function l(m){if(m){k._defaultType=m;return k}return k._defaultType}};f._createDefaultOptions=function(l){return function k(m){if(m){l._defaultOptionsFunc=m;return l}return l._defaultOptionsFunc}};f._mixStaticFunctions=function(l){var m={throwIf:f._createThrowIf(l),reportIf:f._createReportIf(l),defaultType:f._createDefaultType(l),defaultOptionsFunc:f._createDefaultOptions(l)},k;for(k in m){if(!l[k]){l[k]=m[k]}}};f._inherits=function(k,l){k.prototype=Object.create(l.prototype);k.prototype.constructor=k};f._setupDefaults=function(l,m,n,k){l.defaultType(n||m.defaultType());l.defaultOptionsFunc(k||m.defaultOptionsFunc())};function e(l){if(!(this instanceof e)){return new e(l)}var k=this.constructor.defaultOptionsFunc()(new h());this._type=l.type||this.constructor.defaultType();this._error=l.error;this._stacktrace=null;this._innerException=l.innerException||null;this._data=l.data||{};this._options=l.options?l.options(k):k;this._guardedOptions=c.handler.guard().restrict(this._options,this);this._listeners=[];if(this._guardedOptions.stacktrace()){this._stacktrace=this._retrieveStacktrace()}if(this._guardedOptions.screenshot()){this._takeScreenshot()}}f._mixStaticFunctions(e);e.shouldNeverGetHere=function(){throw new e({error:new Error("Should never get here.")})};e.prototype={innerException:function(){return this._innerException},stacktrace:function(){return this._stacktrace},data:function(){return this._data},options:function(){return this._options},type:function(){return this._type},error:function(){return this._error},report:function(){if(!this._screenshotComplete&&this._guardedOptions.screenshot()){this._listeners.push(this._report)}else{this._report()}},_report:function(){if(this._guardedOptions.post()){this._post()}if(this._guardedOptions.callback()){this._callback()}i.pushReportedException(this);console.log("Exception reported:");console.log(this)},_retrieveStacktrace:function(){var k=this.error().stack;if(k){return this.error().stack}if(window.printStackTrace){return window.printStackTrace().join("\n")}if(!i._attemptedToLoadStacktraceJs){i.loadStacktraceJs()}return"Unable to retrieve stacktrace"},_takeScreenshot:function(){var l,k=this;if(!window.html2canvas&&!i._attemptedToLoadHtml2Canvas){i.loadHtml2Canvas(function(){k._takeScreenshot()})}else{if(!window.html2canvas){this._screenshotComplete=true}else{l=function(m){try{this.data().screenshot=m.toDataURL("image/png")}catch(o){console.log("Error in exceptions.js:");console.log(o)}finally{this._screenshotComplete=true}for(var n in this._listeners){this._listeners[n].call(k)}};window.html2canvas(document.body,{onrendered:function(m){l.call(k,m)}})}}},_post:function(){var l=new window.XMLHttpRequest(),k=c.handler.postRequestHeaders(),n=this.toJSONString(),m;l.open("POST",c.handler.postUrl(),true);if(k){for(m=0;m<k.length;m+=1){l.setRequestHeader(k[m].bstrHeader,k[m].bstrValue)}}l.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8");l.send("exception="+encodeURIComponent(n))},toSimpleObject:function(){var k={innerException:this.innerException()?this.innerException().toSimpleObject():null,stacktrace:this.stacktrace(),data:this.data()};this._mergeErrorIntoSimpleObject(k);return k},_callback:function(){var k=c.handler.callback();k(this)},_mergeErrorIntoSimpleObject:function(k){k.message=this._error.message},toJSONString:function(){var k=this.toSimpleObject();return JSON.stringify(k)},constructor:e};e.defaultType("Error");e.defaultOptionsFunc(function(k){return k.toggleAll(true)});g=f({exception:function g(k){if(!(this instanceof g)){return new g(k)}e.call(this,k)},baseException:e,defaultType:"ArgumentException"});j=f({exception:function j(k){if(!(this instanceof j)){return new j(k)}e.call(this,k)},baseException:e,defaultType:"Invalid Operation Exception"});j.shouldNeverGetHere=function(){throw invalidOperationException(new Error("Should never get here."))};function d(){if(!(this instanceof d)){return new d()}this._restrictions=[]}d.prototype={_restrictByAvailableOptions:function(l,k){if(!k.error().stack&&!c.handler.stacktraceUrl()){l.stacktrace(false)}if(!c.handler.html2canvasUrl()){l.screenshot(false)}if(!c.handler.postUrl()){l.post(false)}if(!c.handler.callback()){l.callback(false)}return l},restrictByExceptionsCount:function(l,m){var k=function(p){var n=i.retrieveExceptionsCount(m);if(n>l){p.toggleAll(false)}return p};this._restrictions.push(k);return this},restrictBy:function(k){this._restrictions.push(k);return this},restrict:function(m,l){for(var k in this._restrictions){this._restrictions[k](m,l)}this._restrictByAvailableOptions(m,l);return m}};i={_guard:null,_postUrl:null,_postRequestHeaders:null,_html2canvasUrl:null,_stacktraceUrl:null,_callback:null,_onerror:null,_isSetup:false,_handleAllErrors:true,_handleExceptions:true,_reportedExceptions:[],_setup:function(){if(i._isSetup){return}var k=window.onerror;window.onerror=function(p,n,l,m,o){if(typeof k==="function"){k(p,n,l,m,o)}if(i.handleAllErrors()){i._handle(p,n,l,m,o)}else{if(i.handleExceptions()&&o instanceof e){i._handle(p,n,l,m,o)}}};i._isSetup=true},_setupDefaultGuard:function(){i.guard(function(k){return k.restrictByExceptionsCount(10,10)})},_handle:function(p,m,k,l,o){var q,n;if(o instanceof e){n=o}else{if(o instanceof Error){n=new e({error:o,options:function(r){return r.stacktrace(false)}})}else{n=new e({error:new Error(p),options:function(r){return r.stacktrace(false)}})}}q=n.data();q.url=m;q.lineNumber=k;q.columnNumber=l;n.report()},handleAllErrors:function(k){if(k!==undefined){i._handleAllErrors=Boolean(k);return i}return i._handleAllErrors},handleExceptions:function(k){if(k!==undefined){i._handleExceptions=Boolean(k);return i}return i._handleExceptions},loadStacktraceJs:function(){b.scriptTag(i.stacktraceUrl(),function(){i._attemptedToLoadStacktraceJs=true})},loadHtml2Canvas:function(k){b.scriptTag(c.handler.html2canvasUrl(),function(){i._attemptedToLoadHtml2Canvas=true;k()})},guard:function(k){if(k){i._guard=k(new d());return this}else{return i._guard}},postUrl:function(k){if(k){i._postUrl=k;return i}else{return i._postUrl}},postRequestHeaders:function(k){if(k){i._postRequestHeaders=k;return i}else{return i._postRequestHeaders}},html2canvasUrl:function(k){if(k){i._html2canvasUrl=k;return i}else{return i._html2canvasUrl}},stacktraceUrl:function(k){if(k){i._stacktraceUrl=k;return i}else{return i._stacktraceUrl}},callback:function(k){if(k){i._callback=k;return i}else{return i._callback}},onerror:function(k){if(k){i._onerror=k;return i}else{return i._onerror}},reportedExceptions:function(){return i._reportedExceptions},pushReportedException:function(l){var k=i.reportedExceptions();k.push({exception:l,timestamp:Date.now()})},retrieveExceptionsCount:function(o){var n,m=Date.now(),l,k=i.reportedExceptions();if(o===undefined){return k.length}l=m-(o*1000);for(n=k.length-1;n>=0;n-=1){if(k[n].timestamp>l){break}}return n+1}};i._setupDefaultGuard();i._setup();c={Exception:e,ArgumentException:g,InvalidOperationException:j,handler:i,createCustomException:f};window.exceptions=c}());