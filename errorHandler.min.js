(function(){if(window.errorHandler){console.log("You have loaded errorHandler.js more than once!  Only load it once for performance gains..")}var e,p,r,b,o,j,u,n,s=[];function w(z){return z!=="undefined"&&z!==null}function c(A){var z=window.printStackTrace();A.stack=z.join("\n");return A}function m(z,A){window.html2canvas(document.body,{onrendered:function(B){try{z.screenshot=B.toDataURL("image/png");A(z)}catch(C){console.log("Error in error handler!");console.log(C);A(z)}}})}function q(B){var D=[],z=["stack"],A,C;for(C in B){if(B.hasOwnProperty(C)&&z.indexOf(C)===-1){D.push(encodeURIComponent(C)+"="+encodeURIComponent(B[C]))}}for(A=0;A<z.length;A+=1){C=z[A];if(w(C)){D.push(encodeURIComponent(C)+"="+encodeURIComponent(B[C]))}}return D.join("&")}function i(B){var z=new window.XMLHttpRequest(),A;if(!p){console.log(B)}z.open("POST",p,true);if(r){for(A=0;A<r.length;A+=1){z.setRequestHeader(r[A].bstrHeader,r[A].bstrValue)}}z.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8");z.send(q(B))}function l(z,B){var A=document.createElement("script");A.type="text/javascript";A.src=z;A.async=false;A.onreadystatechange=A.onload=function(){try{var C=A.readyState;if(!B.done&&(!C||/loaded|complete/.test(C))){B.done=true;B()}}catch(D){console.log("Error in error handler!");console.log(D)}};(document.body||document.head).appendChild(A)}function x(E,B,z,A,D){var C={};if(["number","string","boolean"].indexOf(typeof D)!==-1){E=D}else{C=D;E=D.message||E;B=C.url||B;z=C.lineNumber||z;A=C.columnNumber||A}if(w(E)){C.message=E}if(w(B)){C.url=B}if(w(z)){C.lineNumber=z}if(w(A)){C.columnNumber=A}return C}function g(z,A){if(!z.errorHandlerMessages){z.errorHandlerMessages=[]}z.errorHandlerMessages.push(A)}function d(z,B,A){var C={retrieveStackTrace:z.retrieveStacktrace,takeScreenshot:z.takeScreenshot,submitError:z.submitError};if(z.retrieveStacktrace&&!o){C.retrieveStacktrace=false;g(A,"Could not retrieve stack trace because you did not provide a url to retrieve stacktrace.js")}else{if(z.retrieveStacktrace&&!B){C.retrieveStacktrace=false;g(A,"Could not retrieve stack trace because this error is handled with window.onerror which can't produce a good stack trace.")}else{if(z.retrieveStacktrace&&!window.printStackTrace){C.retrieveStacktrace=false;g(A,"Could not retrieve stack trace because stacktrace.js was not loaded before we hit the error.")}}}if(z.submitError&&!p){C.submitError=false;g(A,"Could not submit the error to a server because you did not provide a url to submit the error to.")}if(z.takeScreenshot&&!b){C.takeScreenshot=false;g(A,"Could not take a screenshot because you did not provide a url to retireve html2canvas.js")}else{if(z.takeScreenshot&&!C.submitError){C.takeScreenshot=false;g(A,"We do not take a screenshot if you're not going to submit the error to a server.")}}return C}function v(C){var B,A=Date.now(),z=A-(C*1000);for(B=s.length-1;B>=0;B-=1){if(s[B].timestamp>z){break}}return B+1}function f(A){var C=5,B=1,z=v(B);if(z>C||s.length>20){return{retrieveStacktrace:false,takeScreenshot:false,submitError:false}}return{retrieveStacktrace:!!(A.stack),takeScreenshot:true,submitError:true}}function a(A,z){try{if(z.retrieveStacktrace&&!window.printStackTrace){l(o,function(){a(A,z)});return}if(z.takeScreenshot&&!window.html2canvas){l(b,function(){a(A,z)});return}if(z.retrieveStacktrace){A=c(A)}if(z.takeScreenshot){m(A,function(C){if(z.submitError){i(C)}console.log(C)})}else{if(z.submitError){i(A)}console.log(A)}}catch(B){console.log("Error in error handler!");console.log(B)}}function k(D,z,C,A,G,I){try{var H=x(D,z,C,A,G),B=e(H,s,I),F=d(B,I,H);s.push({timestamp:Date.now(),error:H});a(H,F)}catch(E){console.log("Error in error handler!");console.log(E)}}function h(){var z=window.onerror;window.onerror=function(E,C,A,B,D){if(typeof z==="function"){z(E,C,A,B,D)}if(j){k(E,C,A,B,D,false)}};n=true}function t(z){if(!u){throw new Error("Error handling not set up!  Please use window.errorHandler.configure to configure your error handler before you report errors.")}k(null,window.location.href,null,null,z,true)}function y(z){if(!z.submitErrorUrl){console.log("Please provide a error handler url if you want to send errors to your server.")}if(!z.html2canvasUrl){console.log("Please provide a url to html2canvas if your want to include a screenshot of the page when your report or handle thrown errors.")}if(!z.stacktraceUrl){console.log("Please provide a url to stacktrace.js if you want to include a stack trace when your report errors in all browsers.")}e=z.guard||f;p=z.submitErrorUrl;r=z.submitErrorRequestHeaders;b=z.html2canvasUrl;o=z.stacktraceUrl;j=z.setupWindowOnError;u=true;if(!n&&j){h()}}window.errorHandler={configure:y,report:t}}());